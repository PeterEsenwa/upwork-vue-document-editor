(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["VueDocumentEditor"]=t(require("vue")):e["VueDocumentEditor"]=t(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(){var t={9662:function(e,t,r){var n=r(614),o=r(6330),i=TypeError;e.exports=function(e){if(n(e))return e;throw i(o(e)+" is not a function")}},9670:function(e,t,r){var n=r(111),o=String,i=TypeError;e.exports=function(e){if(n(e))return e;throw i(o(e)+" is not an object")}},1318:function(e,t,r){var n=r(5656),o=r(1400),i=r(6244),p=function(e){return function(t,r,p){var s,c=n(t),a=i(c),l=o(p,a);if(e&&r!=r){while(a>l)if(s=c[l++],s!=s)return!0}else for(;a>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}};e.exports={includes:p(!0),indexOf:p(!1)}},3658:function(e,t,r){"use strict";var n=r(9781),o=r(3157),i=TypeError,p=Object.getOwnPropertyDescriptor,s=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=s?function(e,t){if(o(e)&&!p(e,"length").writable)throw i("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},4326:function(e,t,r){var n=r(1702),o=n({}.toString),i=n("".slice);e.exports=function(e){return i(o(e),8,-1)}},9920:function(e,t,r){var n=r(2597),o=r(3887),i=r(1236),p=r(3070);e.exports=function(e,t,r){for(var s=o(t),c=p.f,a=i.f,l=0;l<s.length;l++){var u=s[l];n(e,u)||r&&n(r,u)||c(e,u,a(t,u))}}},8880:function(e,t,r){var n=r(9781),o=r(3070),i=r(9114);e.exports=n?function(e,t,r){return o.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},9114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},8052:function(e,t,r){var n=r(614),o=r(3070),i=r(6339),p=r(3072);e.exports=function(e,t,r,s){s||(s={});var c=s.enumerable,a=void 0!==s.name?s.name:t;if(n(r)&&i(r,a,s),s.global)c?e[t]=r:p(t,r);else{try{s.unsafe?e[t]&&(c=!0):delete e[t]}catch(l){}c?e[t]=r:o.f(e,t,{value:r,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},3072:function(e,t,r){var n=r(7854),o=Object.defineProperty;e.exports=function(e,t){try{o(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},9781:function(e,t,r){var n=r(7293);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:function(e){var t="object"==typeof document&&document.all,r="undefined"==typeof t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:r}},317:function(e,t,r){var n=r(7854),o=r(111),i=n.document,p=o(i)&&o(i.createElement);e.exports=function(e){return p?i.createElement(e):{}}},7207:function(e){var t=TypeError,r=9007199254740991;e.exports=function(e){if(e>r)throw t("Maximum allowed index exceeded");return e}},8113:function(e){e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7392:function(e,t,r){var n,o,i=r(7854),p=r(8113),s=i.process,c=i.Deno,a=s&&s.versions||c&&c.version,l=a&&a.v8;l&&(n=l.split("."),o=n[0]>0&&n[0]<4?1:+(n[0]+n[1])),!o&&p&&(n=p.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=p.match(/Chrome\/(\d+)/),n&&(o=+n[1]))),e.exports=o},748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(e,t,r){var n=r(7854),o=r(1236).f,i=r(8880),p=r(8052),s=r(3072),c=r(9920),a=r(4705);e.exports=function(e,t){var r,l,u,f,y,d,b=e.target,h=e.global,m=e.stat;if(l=h?n:m?n[b]||s(b,{}):(n[b]||{}).prototype,l)for(u in t){if(y=t[u],e.dontCallGetSet?(d=o(l,u),f=d&&d.value):f=l[u],r=a(h?u:b+(m?".":"#")+u,e.forced),!r&&void 0!==f){if(typeof y==typeof f)continue;c(y,f)}(e.sham||f&&f.sham)&&i(y,"sham",!0),p(l,u,y,e)}}},7293:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},4374:function(e,t,r){var n=r(7293);e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},6916:function(e,t,r){var n=r(4374),o=Function.prototype.call;e.exports=n?o.bind(o):function(){return o.apply(o,arguments)}},6530:function(e,t,r){var n=r(9781),o=r(2597),i=Function.prototype,p=n&&Object.getOwnPropertyDescriptor,s=o(i,"name"),c=s&&"something"===function(){}.name,a=s&&(!n||n&&p(i,"name").configurable);e.exports={EXISTS:s,PROPER:c,CONFIGURABLE:a}},1702:function(e,t,r){var n=r(4374),o=Function.prototype,i=o.call,p=n&&o.bind.bind(i,i);e.exports=n?p:function(e){return function(){return i.apply(e,arguments)}}},5005:function(e,t,r){var n=r(7854),o=r(614),i=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(n[e]):n[e]&&n[e][t]}},8173:function(e,t,r){var n=r(9662),o=r(8554);e.exports=function(e,t){var r=e[t];return o(r)?void 0:n(r)}},7854:function(e,t,r){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||function(){return this}()||this||Function("return this")()},2597:function(e,t,r){var n=r(1702),o=r(7908),i=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},3501:function(e){e.exports={}},4664:function(e,t,r){var n=r(9781),o=r(7293),i=r(317);e.exports=!n&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},8361:function(e,t,r){var n=r(1702),o=r(7293),i=r(4326),p=Object,s=n("".split);e.exports=o((function(){return!p("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?s(e,""):p(e)}:p},2788:function(e,t,r){var n=r(1702),o=r(614),i=r(5465),p=n(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return p(e)}),e.exports=i.inspectSource},9909:function(e,t,r){var n,o,i,p=r(4811),s=r(7854),c=r(111),a=r(8880),l=r(2597),u=r(5465),f=r(6200),y=r(3501),d="Object already initialized",b=s.TypeError,h=s.WeakMap,m=function(e){return i(e)?o(e):n(e,{})},g=function(e){return function(t){var r;if(!c(t)||(r=o(t)).type!==e)throw b("Incompatible receiver, "+e+" required");return r}};if(p||u.state){var O=u.state||(u.state=new h);O.get=O.get,O.has=O.has,O.set=O.set,n=function(e,t){if(O.has(e))throw b(d);return t.facade=e,O.set(e,t),t},o=function(e){return O.get(e)||{}},i=function(e){return O.has(e)}}else{var j=f("state");y[j]=!0,n=function(e,t){if(l(e,j))throw b(d);return t.facade=e,a(e,j,t),t},o=function(e){return l(e,j)?e[j]:{}},i=function(e){return l(e,j)}}e.exports={set:n,get:o,has:i,enforce:m,getterFor:g}},3157:function(e,t,r){var n=r(4326);e.exports=Array.isArray||function(e){return"Array"==n(e)}},614:function(e,t,r){var n=r(4154),o=n.all;e.exports=n.IS_HTMLDDA?function(e){return"function"==typeof e||e===o}:function(e){return"function"==typeof e}},4705:function(e,t,r){var n=r(7293),o=r(614),i=/#|\.prototype\./,p=function(e,t){var r=c[s(e)];return r==l||r!=a&&(o(t)?n(t):!!t)},s=p.normalize=function(e){return String(e).replace(i,".").toLowerCase()},c=p.data={},a=p.NATIVE="N",l=p.POLYFILL="P";e.exports=p},8554:function(e){e.exports=function(e){return null===e||void 0===e}},111:function(e,t,r){var n=r(614),o=r(4154),i=o.all;e.exports=o.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:n(e)||e===i}:function(e){return"object"==typeof e?null!==e:n(e)}},1913:function(e){e.exports=!1},2190:function(e,t,r){var n=r(5005),o=r(614),i=r(7976),p=r(3307),s=Object;e.exports=p?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return o(t)&&i(t.prototype,s(e))}},6244:function(e,t,r){var n=r(7466);e.exports=function(e){return n(e.length)}},6339:function(e,t,r){var n=r(1702),o=r(7293),i=r(614),p=r(2597),s=r(9781),c=r(6530).CONFIGURABLE,a=r(2788),l=r(9909),u=l.enforce,f=l.get,y=String,d=Object.defineProperty,b=n("".slice),h=n("".replace),m=n([].join),g=s&&!o((function(){return 8!==d((function(){}),"length",{value:8}).length})),O=String(String).split("String"),j=e.exports=function(e,t,r){"Symbol("===b(y(t),0,7)&&(t="["+h(y(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!p(e,"name")||c&&e.name!==t)&&(s?d(e,"name",{value:t,configurable:!0}):e.name=t),g&&r&&p(r,"arity")&&e.length!==r.arity&&d(e,"length",{value:r.arity});try{r&&p(r,"constructor")&&r.constructor?s&&d(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(o){}var n=u(e);return p(n,"source")||(n.source=m(O,"string"==typeof t?t:"")),e};Function.prototype.toString=j((function(){return i(this)&&f(this).source||a(this)}),"toString")},4758:function(e){var t=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){var n=+e;return(n>0?r:t)(n)}},3070:function(e,t,r){var n=r(9781),o=r(4664),i=r(3353),p=r(9670),s=r(4948),c=TypeError,a=Object.defineProperty,l=Object.getOwnPropertyDescriptor,u="enumerable",f="configurable",y="writable";t.f=n?i?function(e,t,r){if(p(e),t=s(t),p(r),"function"===typeof e&&"prototype"===t&&"value"in r&&y in r&&!r[y]){var n=l(e,t);n&&n[y]&&(e[t]=r.value,r={configurable:f in r?r[f]:n[f],enumerable:u in r?r[u]:n[u],writable:!1})}return a(e,t,r)}:a:function(e,t,r){if(p(e),t=s(t),p(r),o)try{return a(e,t,r)}catch(n){}if("get"in r||"set"in r)throw c("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},1236:function(e,t,r){var n=r(9781),o=r(6916),i=r(5296),p=r(9114),s=r(5656),c=r(4948),a=r(2597),l=r(4664),u=Object.getOwnPropertyDescriptor;t.f=n?u:function(e,t){if(e=s(e),t=c(t),l)try{return u(e,t)}catch(r){}if(a(e,t))return p(!o(i.f,e,t),e[t])}},8006:function(e,t,r){var n=r(6324),o=r(748),i=o.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},5181:function(e,t){t.f=Object.getOwnPropertySymbols},7976:function(e,t,r){var n=r(1702);e.exports=n({}.isPrototypeOf)},6324:function(e,t,r){var n=r(1702),o=r(2597),i=r(5656),p=r(1318).indexOf,s=r(3501),c=n([].push);e.exports=function(e,t){var r,n=i(e),a=0,l=[];for(r in n)!o(s,r)&&o(n,r)&&c(l,r);while(t.length>a)o(n,r=t[a++])&&(~p(l,r)||c(l,r));return l}},5296:function(e,t){"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,o=n&&!r.call({1:2},1);t.f=o?function(e){var t=n(this,e);return!!t&&t.enumerable}:r},2140:function(e,t,r){var n=r(6916),o=r(614),i=r(111),p=TypeError;e.exports=function(e,t){var r,s;if("string"===t&&o(r=e.toString)&&!i(s=n(r,e)))return s;if(o(r=e.valueOf)&&!i(s=n(r,e)))return s;if("string"!==t&&o(r=e.toString)&&!i(s=n(r,e)))return s;throw p("Can't convert object to primitive value")}},3887:function(e,t,r){var n=r(5005),o=r(1702),i=r(8006),p=r(5181),s=r(9670),c=o([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=i.f(s(e)),r=p.f;return r?c(t,r(e)):t}},4488:function(e,t,r){var n=r(8554),o=TypeError;e.exports=function(e){if(n(e))throw o("Can't call method on "+e);return e}},6200:function(e,t,r){var n=r(2309),o=r(9711),i=n("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},5465:function(e,t,r){var n=r(7854),o=r(3072),i="__core-js_shared__",p=n[i]||o(i,{});e.exports=p},2309:function(e,t,r){var n=r(1913),o=r(5465);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.31.1",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:function(e,t,r){var n=r(7392),o=r(7293),i=r(7854),p=i.String;e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!p(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},1400:function(e,t,r){var n=r(9303),o=Math.max,i=Math.min;e.exports=function(e,t){var r=n(e);return r<0?o(r+t,0):i(r,t)}},5656:function(e,t,r){var n=r(8361),o=r(4488);e.exports=function(e){return n(o(e))}},9303:function(e,t,r){var n=r(4758);e.exports=function(e){var t=+e;return t!==t||0===t?0:n(t)}},7466:function(e,t,r){var n=r(9303),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},7908:function(e,t,r){var n=r(4488),o=Object;e.exports=function(e){return o(n(e))}},7593:function(e,t,r){var n=r(6916),o=r(111),i=r(2190),p=r(8173),s=r(2140),c=r(5112),a=TypeError,l=c("toPrimitive");e.exports=function(e,t){if(!o(e)||i(e))return e;var r,c=p(e,l);if(c){if(void 0===t&&(t="default"),r=n(c,e,t),!o(r)||i(r))return r;throw a("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},4948:function(e,t,r){var n=r(7593),o=r(2190);e.exports=function(e){var t=n(e,"string");return o(t)?t:t+""}},6330:function(e){var t=String;e.exports=function(e){try{return t(e)}catch(r){return"Object"}}},9711:function(e,t,r){var n=r(1702),o=0,i=Math.random(),p=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+p(++o+i,36)}},3307:function(e,t,r){var n=r(6293);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(e,t,r){var n=r(9781),o=r(7293);e.exports=n&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},4811:function(e,t,r){var n=r(7854),o=r(614),i=n.WeakMap;e.exports=o(i)&&/native code/.test(String(i))},5112:function(e,t,r){var n=r(7854),o=r(2309),i=r(2597),p=r(9711),s=r(6293),c=r(3307),a=n.Symbol,l=o("wks"),u=c?a["for"]||a:a&&a.withoutSetter||p;e.exports=function(e){return i(l,e)||(l[e]=s&&i(a,e)?a[e]:u("Symbol."+e)),l[e]}},7658:function(e,t,r){"use strict";var n=r(2109),o=r(7908),i=r(6244),p=r(3658),s=r(7207),c=r(7293),a=c((function(){return 4294967297!==[].push.call({length:4294967296},1)})),l=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},u=a||!l();n({target:"Array",proto:!0,arity:1,forced:u},{push:function(e){var t=o(this),r=i(t),n=arguments.length;s(r+n);for(var c=0;c<n;c++)t[r]=arguments[c],r++;return p(t,r),r}})},3744:function(e,t){"use strict";t.Z=(e,t)=>{const r=e.__vccOpts||e;for(const[n,o]of t)r[n]=o;return r}},7203:function(t){"use strict";t.exports=e}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}};return t[e].call(i.exports,i,i.exports,n),i.exports}!function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p=""}();var o={};return function(){"use strict";if(n.d(o,{default:function(){return M}}),"undefined"!==typeof window){var e=window.document.currentScript,t=e&&e.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);t&&(n.p=t[1])}var r=n(7203);const i={class:"editor",ref:"editorRef"},p={key:0,class:"overlays",ref:"overlays"},s=["innerHTML"],c=["contenteditable"];function a(e,t,n,o,a,l){return(0,r.openBlock)(),(0,r.createElementBlock)("div",i,[n.overlay?((0,r.openBlock)(),(0,r.createElementBlock)("div",p,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(o.pages,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"overlay",key:e.uuid+"-overlay",ref_for:!0,ref:t=>o.pages_overlay_refs[e.uuid]=t,innerHTML:n.overlay(t+1,o.pages.length),style:(0,r.normalizeStyle)(o.page_style(t,!1))},null,12,s)))),128))],512)):(0,r.createCommentVNode)("",!0),(0,r.createElementVNode)("div",{class:"content",ref:"contentRef",contenteditable:n.editable,style:(0,r.normalizeStyle)(o.page_style(-1)),onInput:t[0]||(t[0]=(...e)=>l.input&&l.input(...e)),onKeyup:t[1]||(t[1]=(...e)=>l.process_current_text_style&&l.process_current_text_style(...e)),onKeydown:t[2]||(t[2]=(...e)=>o.onKeydown&&o.onKeydown(...e))},null,44,c)],512)}n(7658);let l=(e,t=21)=>(r=t)=>{let n="",o=r;while(o--)n+=e[Math.random()*e.length|0];return n};function u(e,t){if(!e||!t)return!1;const r=e.childNodes;for(let n=0;n<r.length;n++)if(r[n].s_tag==t)return r[n];return!1}function f(e,t,r,n,o){while(e.childNodes.length&&!r()){o=o||1!=e.childNodes.length;const i=e.lastChild;if(i.nodeType==Node.TEXT_NODE){const e=i.textContent.match(/(\s|\S+)/g),n=document.createTextNode("");t.prepend(n);const p=e?e.length:0;for(let t=0;t<p;t++){if(t==p-1&&!o)return;if(i.textContent=e.slice(0,p-t-1).join(""),n.textContent=e.slice(p-t-1,p).join(""),r())return}}else if(!i.childNodes.length||i.tagName.match(/h\d/i)||i.tagName.match(/tr/i)||"function"===typeof n&&n(i)){if(!o)return void console.log("Move-forward: first child reached with no stop condition. Aborting");t.prepend(i)}else{let e=u(t,i.s_tag);if(!e){if(!i.s_tag){const e=Math.random().toString(36).slice(2,8);i.s_tag=e}e=i.cloneNode(!1),e.s_tag=i.s_tag,t.prepend(e)}f(i,e,r,n,o),e.normalize()}if(e.contains(i))if(0==i.childNodes.length||""==i.innerHTML)e.removeChild(i);else if(!r())throw console.log("sub_child:",i,"that is in child:",e),Error("Document editor is trying to remove a non-empty sub-child. This is a bug and should not happen. Please report a repeatable set of actions that leaded to this error to https://github.com/motla/vue-document-editor/issues/new")}}function y(e,t,r){while(!r()){const r=t.firstChild;var n=(e,t)=>{const r=u(e,t.s_tag);r&&t.childNodes.length?n(r,t.firstChild):(e.append(t),e.normalize())};n(e,r)}}var d=()=>{const e=document.createElement("style");return document.head.appendChild(e),e};function b({contentRef:e,pages:t,pageStyle:r,printingMode:n,props:o}){const i=()=>{const i=[...e.value?.children??[]].filter((e=>{t.value.find((t=>t.elt===e))}));for(const e of i)e.remove();for(const[p,s]of t.value.entries()){if(!s.elt){s.elt=document.createElement("div"),s.elt.className="page",s.elt.dataset.isVDEPage="";const r=t.value[p+1];e.value?.insertBefore(s.elt,r?r.elt:null)}s.elt.dataset.contentIdx=s.content_idx,n.value||(s.elt.style=Object.entries(r(p,!s.template)).map((([e,t])=>e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))+":"+t)).join(";")),s.elt.contentEditable=o.editable&&!s.template}};return{updatePagesELTs:i}}var h=(e,t)=>{const n=(0,r.ref)([]),o=(0,r.ref)({}),i=(0,r.ref)(0),p=(0,r.ref)(0),s=(0,r.ref)(!1),c=(0,r.ref)(!1),a=(0,r.ref)(!1),l=(0,r.ref)(!1),u=(0,r.ref)(),f=(0,r.ref)(),y=(0,r.computed)((()=>d()));function h(t,r=!1){const o=.2645833333333,i=e.page_format_mm[0]/o,s=10,c=(s+e.page_format_mm[0])*e.zoom/o,a=20,l=p.value-2*a;let u,f,y,d,b,h,m,g=1;if("horizontal"==e.display)l>n.value.length*c?(g=Math.floor(l/c),d=l/(2*g)*(1+2*t)-i/2):(g=n.value.length,d=c*t+i/2*(e.zoom-1)),b=0,h=e.zoom*(e.page_format_mm[0]*g+(g-1)*s),m=e.page_format_mm[1]*e.zoom;else{g=Math.floor(l/c),(g<1||"vertical"==e.display)&&(g=1),u=t%g,f=l/(2*g)*(1+2*u)-i/2,y=Math.max(0,(i*e.zoom-l)/2),d=f+y,b=(e.page_format_mm[1]+s)*e.zoom*Math.floor(t/g);const r=Math.ceil(n.value.length/g);h=e.zoom*(e.page_format_mm[0]*g+(g-1)*s),m=e.zoom*(e.page_format_mm[1]*r+(r-1)*s)}if(t>=0){const o={position:"absolute",left:"calc("+d+"px + "+a+"px)",top:"calc("+b+"mm + "+a+"px)",width:e.page_format_mm[0]+"mm",padding:"function"==typeof e.page_margins?e.page_margins(t+1,n.value.length):e.page_margins,transform:"scale("+e.zoom+")"};return o[r?"minHeight":"height"]=e.page_format_mm[1]+"mm",o}return{width:"calc("+h+"mm + "+2*a+"px)",height:"calc("+m+"mm + "+2*a+"px)"}}const{updatePagesELTs:m}=b({contentRef:u,pages:n,pageStyle:h,printingMode:a,props:e});function g(){f.value?.classList.add("hide_children"),p.value=f.value?.clientWidth||0,m(),f.value?.classList.remove("hide_children")}function O(){y.value.innerHTML=`\n\t\t\t@media print {\n\t\t\t\t@page {\n\t\t\t\t\tsize: ${e.page_format_mm[0]} mm ${e.page_format_mm[1]} mm;\n\t\t\t\t\tmargin: 0 !important;\n\t\t\t\t}\n\t\t\t\n\t\t\t\t.hidden-print {\n\t\t\t\t\tdisplay: none !important;\n\t\t\t\t}\n\t\t\t}`}return(0,r.onMounted)((()=>{g(),O(),window.addEventListener("resize",g)})),(0,r.onBeforeUpdate)((()=>{o.value={}})),(0,r.onBeforeUnmount)((()=>{window.removeEventListener("resize",g)})),(0,r.watch)([()=>e.display,()=>e.zoom],(()=>{m()})),{pages:n,pages_overlay_refs:o,pages_height:i,editor_width:p,prevent_next_content_update_from_parent:s,current_text_style:c,printing_mode:a,reset_in_progress:l,contentRef:u,editorRef:f,css_media_style:y,page_style:h,updatePagesELTs:m,update_editor_width:g,update_css_media_style:O}};Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;const m="undefined"!==typeof window,g=(Object.prototype.toString,()=>{}),O=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function j(...e){if(1!==e.length)return(0,r.toRef)(...e);const t=e[0];return"function"===typeof t?(0,r.readonly)((0,r.customRef)((()=>({get:t,set:g})))):(0,r.ref)(t)}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var v=!1;function _(e,t,r){return Array.isArray(e)?(e.length=Math.max(e.length,t),e.splice(t,1,r),r):(e[t]=r,r)}function w(e,t){Array.isArray(e)?e.splice(t,1):delete e[t]}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;m&&window,m&&window.document,m&&window.navigator,m&&window.location;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function P(){const e=(0,r.reactive)({});return{get:t=>e[t],set:(t,r)=>_(e,t,r),has:t=>O(e,t),delete:t=>w(e,t),clear:()=>{Object.keys(e).forEach((t=>{w(e,t)}))}}}function x(e,t){const n=()=>(null==t?void 0:t.cache)?(0,r.reactive)(t.cache):v?P():(0,r.reactive)(new Map),o=n(),i=(...e)=>(null==t?void 0:t.getKey)?t.getKey(...e):JSON.stringify(e),p=(t,...r)=>(o.set(t,e(...r)),o.get(t)),s=(...e)=>p(i(...e),...e),c=(...e)=>{o.delete(i(...e))},a=()=>{o.clear()},l=(...e)=>{const t=i(...e);return o.has(t)?o.get(t):p(t,...e)};return l.load=s,l.delete=c,l.clear=a,l.generateKey=i,l.cache=o,l}Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var E=e=>{const t=(0,r.computed)((()=>e.value[0])),n=x((e=>"string"===typeof e)),o=(0,r.computed)((()=>{if(n(t.value))return t.value?.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")})),i=t=>{t.key&&"Backspace"!==t.key||e.value.length>1||o.value||t.preventDefault()};return{onKeydown:i}};const S=l("1234567890",5);var I={props:{content:{type:Array,required:!0},display:{type:String,default:"grid"},editable:{type:Boolean,default:!0},overlay:Function,page_format_mm:{type:Array,default:()=>[210,297]},page_margins:{type:[String,Function],default:"10mm 15mm"},zoom:{type:Number,default:1},do_not_break:Function},mounted(){this.reset_content(),window.addEventListener("click",this.process_current_text_style),window.addEventListener("beforeprint",this.before_print),window.addEventListener("afterprint",this.after_print)},beforeUnmount(){window.removeEventListener("click",this.process_current_text_style),window.removeEventListener("beforeprint",this.before_print),window.removeEventListener("afterprint",this.after_print)},methods:{reset_content(){if(this.reset_in_progress)return;if(this.reset_in_progress=!0,!this.content.length)return this.reset_in_progress=!1,void this.$emit("update:content",[""]);this.pages=this.content.map(((e,t)=>({uuid:S(5),content_idx:t,template:e.template,props:e.props}))),this.updatePagesELTs();const e=this.pages[0].elt;this.$refs.contentRef.contains(e)||this.$refs.contentRef.appendChild(e),this.pages_height=e.clientHeight+1;for(const t of this.pages){if(this.content[t.content_idx]){if("string"==typeof this.content[t.content_idx])t.elt.innerHTML="<div>"+this.content[t.content_idx]+"</div>";else if(t.template){const e=(0,r.defineCustomElement)(t.template);customElements.define("component-"+t.uuid,e),t.elt.appendChild(new e({modelValue:t.props}))}}else t.elt.innerHTML="<div><br></div>";this.$refs.contentRef.contains(t.elt)||this.$refs.contentRef.appendChild(t.elt)}this.fit_content_over_pages(),this.$refs.contentRef.blur(),this.reset_in_progress=!1},fit_content_over_pages(){if(!this.pages_height)return;if(this.fit_in_progress)return;this.fit_in_progress=!0;for(let o=this.pages.length-1;o>=0;o--){const e=this.pages[o];e.elt&&document.body.contains(e.elt)||this.pages.splice(o,1)}if(!this.pages.length)return void this.$emit("update:content",[""]);const e=window.getSelection(),t=document.createElement("null"),r=document.createElement("null");if(e&&e.rangeCount&&e.anchorNode&&(!e.anchorNode.dataset||null==e.anchorNode.dataset.isVDEPage)){const n=e.getRangeAt(0);n.insertNode(t),n.collapse(!1),n.insertNode(r)}let n=!1;for(let o=0;o<this.pages.length;o++){const e=this.pages[o];let t=this.pages[o+1],r=t?t.elt:null;!e.template&&(n||e.elt.innerHTML!=e.prev_innerHTML||r&&!t.template&&r.innerHTML!=t.prev_innerHTML)&&(n=!0,e.elt.clientHeight<=this.pages_height&&t&&t.content_idx==e.content_idx&&y(e.elt,r,(()=>!r.childNodes.length||e.elt.clientHeight>this.pages_height)),e.elt.clientHeight>this.pages_height&&(t&&t.content_idx==e.content_idx||(t={uuid:S(5),content_idx:e.content_idx},this.pages.splice(o+1,0,t),this.updatePagesELTs(),r=t.elt),f(e.elt,r,(()=>e.elt.clientHeight<=this.pages_height),this.do_not_break)),r&&t.content_idx==e.content_idx&&!r.childNodes.length&&this.pages.splice(o+1,1)),this.updatePagesELTs()}if(document.body.contains(t)){const n=document.createRange();n.setStart(t,0),document.body.contains(r)&&n.setEnd(r,0),e.removeAllRanges(),e.addRange(n)}t.parentElement&&t.parentElement.removeChild(t),r.parentElement&&r.parentElement.removeChild(r);for(const o of this.pages)o.template||o.elt.normalize(),o.prev_innerHTML=o.elt.innerHTML;this.fit_in_progress=!1},input(e){e&&(this.fit_content_over_pages(),this.emit_new_content(),"insertText"!=e.inputType&&this.process_current_text_style())},emit_new_content(){let e=!1;const t=this.content.map(((t,r)=>{const n=this.pages.filter((e=>e.content_idx==r));return n.length?"string"==typeof t?n.map((e=>{let t=e.elt;while(1==t.children.length&&t.firstChild.tagName&&"div"==t.firstChild.tagName.toLowerCase()&&!t.firstChild.getAttribute("style"))t=t.firstChild;return t.innerHTML})).join("")||!1:{template:t.template,props:{...t.props}}:(e=!0,!1)})).filter((e=>0!=e));e||(this.prevent_next_content_update_from_parent=!0),this.$emit("update:content",t)},process_current_text_style(){let e=!1;const t=window.getSelection();if(t.focusNode){const r=t.focusNode.tagName?t.focusNode:t.focusNode.parentElement;if(r&&r.isContentEditable){e=window.getComputedStyle(r),e.textDecorationStack=[],e.headerLevel=0,e.isList=!1;let t=r;while(t){const r=window.getComputedStyle(t);if(e.textDecorationStack.push(r.textDecoration),"list-item"==r.display&&(e.isList=!0),!e.headerLevel)for(let n=1;n<=6;n++)if(t.tagName.toUpperCase()=="H"+n){e.headerLevel=n;break}t=t.parentElement}}}this.current_text_style=e},css_to_string:e=>Object.entries(e).map((([e,t])=>e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))+":"+t)).join(";"),before_print(){this.printing_mode=!0,this._page_body=document.body;const e=document.createElement("body");e.style.margin="0",e.style.padding="0",e.style.background="white",e.style.font=window.getComputedStyle(this.$refs.editorRef).font,e.className=this.$refs.editorRef.className;for(const[r,n]of this.pages.entries()){n.elt.style="",n.elt.style.position="relative",n.elt.style.padding="function"==typeof this.page_margins?this.page_margins(r+1,this.pages.length):this.page_margins,n.elt.style.breakBefore=r?"page":"auto",n.elt.style.width="calc("+this.page_format_mm[0]+"mm - 2px)",n.elt.style.height="calc("+this.page_format_mm[1]+"mm - 2px)",n.elt.style.boxSizing="border-box",n.elt.style.overflow="hidden";const t=this.pages_overlay_refs[n.uuid];t&&(t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.transform="none",t.style.padding="0",t.style.overflow="hidden",n.elt.prepend(t)),e.append(n.elt)}const t=document.createElement("div");t.className="hidden-print",t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.right="0",t.style.bottom="0",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.background="rgba(255, 255, 255, 0.95)",t.style.cursor="pointer",t.innerHTML='<svg width="220" height="220"><path fill="rgba(0, 0, 0, 0.7)" d="M120.774,179.271v40c47.303,0,85.784-38.482,85.784-85.785c0-47.3-38.481-85.782-85.784-85.782H89.282L108.7,28.286L80.417,0L12.713,67.703l67.703,67.701l28.283-28.284L89.282,87.703h31.492c25.246,0,45.784,20.538,45.784,45.783C166.558,158.73,146.02,179.271,120.774,179.271z"/></svg>',t.addEventListener("click",this.after_print),e.append(t),document.body=e},after_print(){this.printing_mode=!1;for(const[e,t]of this.pages.entries()){t.elt.style=this.css_to_string(this.page_style(e,!t.template)),this.$refs.contentRef.append(t.elt);const r=this.pages_overlay_refs[t.uuid];r&&(r.style=this.css_to_string(this.page_style(e,!1)),this.$refs.overlays.append(r))}document.body=this._page_body,this.update_editor_width()}},watch:{content:{handler(){this.prevent_next_content_update_from_parent?this.prevent_next_content_update_from_parent=!1:this.reset_content()},deep:!0},page_format_mm:{handler(){this.update_css_media_style(),this.reset_content()}},page_margins:{handler(){this.reset_content()}}},setup(e,{emit:t}){const{pages:r,pages_overlay_refs:n,pages_height:o,editor_width:i,prevent_next_content_update_from_parent:p,current_text_style:s,printing_mode:c,css_media_style:a,contentRef:l,editorRef:u,page_style:f,updatePagesELTs:y,update_editor_width:d,update_css_media_style:b}=h(e,t),m=j(e,"content"),{onKeydown:g}=E(m);return{pages:r,pages_overlay_refs:n,pages_height:o,editor_width:i,prevent_next_content_update_from_parent:p,current_text_style:s,printing_mode:c,css_media_style:a,contentRef:l,editorRef:u,page_style:f,updatePagesELTs:y,update_editor_width:d,update_css_media_style:b,onKeydown:g}}},L=n(3744);const T=(0,L.Z)(I,[["render",a],["__scopeId","data-v-0c551d4e"]]);var D=T,M=D}(),o=o["default"],o}()}));
//# sourceMappingURL=VueDocumentEditor.umd.min.js.map